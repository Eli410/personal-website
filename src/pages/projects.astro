---
import "../styles/projects.css";
import Layout from "../layouts/Layout.astro";
import Hero from "../components/commons/hero/hero.astro";
import ProjectSection from "../components/project/ProjectSection.astro";
import Footer from "../components/commons/footer/footer.astro";
import { proyectos } from "../data/projectData.js";
---

<Layout title="Projects" description="Explore my projects and work">
  <Hero titulo="Projects" />

  <main class="projects-page">
    {
      proyectos.map((proyecto, index) => (
        <ProjectSection
          index={index}
          titulo={proyecto.titulo}
          descripcion={proyecto.descripcion}
          imagen={proyecto.imagen}
          tecnologias={proyecto.tecnologias}
          url={proyecto.url}
          github={proyecto.github}
          categoria={proyecto.categoria}
          role={proyecto.role}
          dateRange={proyecto.dateRange}
          subtitle={proyecto.subtitle}
        />
      ))
    }
  </main>

  <Footer />
</Layout>

<script is:inline>
(function () {
  function initReveal() {
    const sections = document.querySelectorAll(".project-section");
    if (!sections.length) return;

    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            entry.target.classList.add("is-visible");
          }
        });
      },
      {
        rootMargin: "0px 0px -60px 0px",
        threshold: 0.1,
      }
    );

    sections.forEach((section) => observer.observe(section));
  }

  document.addEventListener("astro:page-load", initReveal);
  window.addEventListener("load", initReveal);
})();
</script>
