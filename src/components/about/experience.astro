---
// CSS
import "../../styles/experiencie.css";

// Optimized logos (Astro will resize to 48Ã—48 and optimize format at build)
import { Image } from "astro:assets";
import hexagonLogo from "../../assets/logos/Hexagon_logo.png";
import shepherdLogo from "../../assets/logos/Shepherd_ventures_logo.png";
import tamuLogo from "../../assets/logos/TAMU_logo.png";

const logoMap = { hexagon: hexagonLogo, shepherd: shepherdLogo, tamu: tamuLogo };

// Data
import { jobs } from "../../data/jobsData";
---

<section class="site-container experience mt-16 mx-auto w-full max-w-6xl px-4 bg-transparent">
  <h2
    class="text-4xl font-bold flex flex-col items-center gap-6 text-center whitespace-nowrap text-[#38bdf8] md:flex-row md:items-center md:text-start"
  >
    <span>My Experience</span>
    <span
      class="hidden h-1 grow rounded-lg bg-gradient-to-r from-[#1e293b] to-[#38bdf8]/30 md:block"
    ></span>
  </h2>

  <section class="jobs">
    <div class="job-title" data-lenis-prevent>
      <div class="job-title-indicator" aria-hidden="true"></div>
      <div class="job-title-icon-box" aria-hidden="true"></div>
      {
        jobs.map((job, index) => {
          const company = job.title.includes(" - ") ? job.title.split(" - ").slice(1).join(" - ") : job.title;
          return (
            <button
              class={`headline-3 tabbutton ${index === 0 ? "active" : ""}`}
              aria-selected={index === 0 ? "true" : "false"}
              data-index={index}
              title={company}
            >
              <span class="job-title-icon" aria-hidden="true">
                {job.logo && logoMap[job.logo] ? (
                  <Image src={logoMap[job.logo]} width={48} height={48} alt="" class="job-logo" />
                ) : (
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="2" y="7" width="20" height="14" rx="2" ry="2"/>
                    <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/>
                  </svg>
                )}
              </span>
              <span class="job-title-text">{company}</span>
            </button>
          );
        })
      }
    </div>

    <div class="jobs-descriptions">
      {
        jobs.map(({ title, time, description, list }, index) => (
          <div
            class={`description tabcontent text-left ${index === 0 ? "active" : ""}`}
            data-index={index}
          >
            <h3 class="mb-2 text-2xl font-bold text-[#38bdf8] text-center">{title}</h3>
            <div class="job-time">
              {time.map((t) => (
                <time class="headline-4 text-zinc-500 mb-1" datetime={t}>
                  {t}
                </time>
              ))}
            </div>
            <p class="mb-3 text-zinc-300 text-center">{description}</p>
            <ul class="bullet-list marker:text-[#7dd3fc] list-disc list-outside space-y-2 pl-5 text-zinc-400 text-left">
              {list.map((item, i) => (
                <li class="bullet-item" style={`animation-delay: ${i * 0.15}s`}>{item}</li>
              ))}
            </ul>
          </div>
        ))
      }
    </div>
  </section>

  <div class="side-line"></div>
</section>

<script>
  import { initExperienceTabs } from "../../scripts/experienceTabs.js";

  initExperienceTabs();
  document.addEventListener("astro:after-swap", initExperienceTabs);
</script>
